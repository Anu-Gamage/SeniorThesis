Working copy of C-RSP, cleaned up and sparsified from before
